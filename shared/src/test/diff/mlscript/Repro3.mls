:NoJS


// TODO use RecType immediately for all TVs in canon?


:stdout
:s
:d
:ds
def f: { x: 'a } as 'a


// :stdout
// :s
// :d
// :ds
rec def l a = l
//│ l: anything -> 'a as 'a


// TODO-simplif
// :ds
fun a -> a a
//│ res: 'a
//│ 	where
//│ 		'a :> 'a -> 'b
//│ 		   <: 'a -> 'b & 'a


// :stdout
// :s
// :d
// :ds
:e
rec def f a = a a
//│ ('b & ('c,)) -> 'd as 'a
//│ 	where
//│ 		'c <: 'a
//│   <:  f:
//│ {x: 'a} as 'a
//│ ╔══[ERROR] Type mismatch in def definition:
//│ ║  l.36: 	rec def f a = a a
//│ ║        	^^^^^^^^^^^^^^^^^
//│ ╟── function of type `?b -> ?c` does not match type `{x: ?a} | 'a`
//│ ║  l.36: 	rec def f a = a a
//│ ║        	          ^^^^^^^
//│ ╟── Note: constraint arises from local type binding:
//│ ║  l.11: 	def f: { x: 'a } as 'a
//│ ╙──      	       ^^^^^^^^^

// :stdout
// :s
// :d
// :ds
rec def g a = a a
//│ g: ('b & ('c,)) -> 'd as 'a
//│ 	where
//│ 		'c <: 'a




